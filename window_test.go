package ui

import (
	"image/color"
	"testing"
)

func TestWindow(t *testing.T) {
	w, h := 30, 20
	wnd := NewWindow(w, h)
	wnd.SetTitleColor(color.Black)
	wnd.SetBackgroundColor(color.Black)
	wnd.SetBorderColor(color.White)
	wnd.HideCloseButton()

	btn := NewButton(20, 14).SetText("HI")
	btn.Text.setFont(tinyFontName)
	btn.Position = Point{X: 5, Y: 3}
	wnd.AddChild(btn)

	// make sure same frame is delivered each time
	for i := 0; i < 10; i++ {
		im := wnd.Draw(0, 0)
		testCompareRender(t, []string{
			"##############################",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,####################,,,,#",
			"#,,,,#,,,,,,,,,,,,,,,,,,#,,,,#",
			"#,,,,#,,,,,,,,,,,,,,,,,,#,,,,#",
			"#,,,,#,66+,56o,,666666o,#,,,,#",
			"#,,,,#,##+,6#5,,######5,#,,,,#",
			"#,,,,#,##+,6#5,,550#65+,#,,,,#",
			"#,,,,#,##+,6#5,,,,O#o,,,#,,,,#",
			"#,,,,#,##5oO#5,,,,O#o,,,#,,,,#",
			"#,,,,#,######5,,,,O#o,,,#,,,,#",
			"#,,,,#,##0O0#5,,++0#5+,,#,,,,#",
			"#,,,,#,##+,6#5,,######5,#,,,,#",
			"#,,,,#,##+,6#5,,######5,#,,,,#",
			"#,,,,#,,,,,,,,,,,,,,,,,,#,,,,#",
			"#,,,,####################,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"##############################",
		}, renderAsText(im))
	}
}

func TestWindowWithTitle(t *testing.T) {
	w, h := 30, 20
	wnd := NewWindow(w, h)
	wnd.SetTitle("WOA")
	wnd.SetTitleColor(color.Black)
	wnd.SetBackgroundColor(color.Black)
	wnd.HideCloseButton()

	// make sure same frame is delivered each time
	for i := 0; i < 10; i++ {
		im := wnd.Draw(0, 0)
		testCompareRender(t, []string{
			"##############################",
			"#o5,,,,,6+,,oO0O+,,,,,+O,,,,,#",
			"#oO,,,,,0+,50o,o0+,,,,605,,,,#",
			"#oO,,,,+#,,0o,,,5O,,,,0oO,,,,#",
			"#+0,+5,+0,o0,,,,+0,,,56,0+,,,#",
			"#+0,O#oo0,o0,,,,+#+,,Oo,66,,,#",
			"#+0o##O5O,o0,,,,+#,,+0,,+0,,,#",
			"#,#006#06,,06+,+OO,,60OOO#5,,#",
			"#,0#6,0#6,,6#####o,,0O666OO,,#",
			"#,00+,5#5,,,60#05,,o0+,,,o#+,#",
			"#,,,,,,,,,,,,,+,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"##############################",
		}, renderAsText(im))
	}
}
