package ui

import (
	"image/color"
	"testing"
)

func TestWindow(t *testing.T) {
	w, h := 30, 20
	wnd := NewWindow(w, h)
	wnd.SetTitleColor(color.Black)
	wnd.SetBackgroundColor(color.Black)
	wnd.SetBorderColor(color.White)
	wnd.HideCloseButton()

	btn := NewButton(20, 14).SetText("HI")
	btn.Text.setFont(tinyFontName)
	btn.Position = Point{X: 5, Y: 3}
	wnd.AddChild(btn)

	// make sure same frame is delivered each time
	for i := 0; i < 10; i++ {
		im := wnd.Draw(0, 0)
		testCompareRender(t, []string{
			"##############################",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,####################,,,,#",
			"#,,,,#,,,,,,,,,,,,,,,,,,#,,,,#",
			"#,,,,#,,,,,,,,,,,,,,,,,,#,,,,#",
			"#,,,,#oo,,o+,ooooo+,,,,,#,,,,#",
			"#,,,,##O,o#5,#####5,,,,,#,,,,#",
			"#,,,,##O,o#5,56#O5+,,,,,#,,,,#",
			"#,,,,##O,o#5,,+#6,,,,,,,#,,,,#",
			"#,,,,##06O#5,,+#6,,,,,,,#,,,,#",
			"#,,,,######5,,+#6,,,,,,,#,,,,#",
			"#,,,,##0+5#5,O0#0O5,,,,,#,,,,#",
			"#,,,,##O,o#5,#####5,,,,,#,,,,#",
			"#,,,,#,,,,,,,,,,,,,,,,,,#,,,,#",
			"#,,,,#,,,,,,,,,,,,,,,,,,#,,,,#",
			"#,,,,####################,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"##############################",
		}, renderAsText(im))
	}
}

func TestWindowWithTitle(t *testing.T) {
	w, h := 40, 20
	wnd := NewWindow(w, h)
	wnd.SetTitle("WOA")
	wnd.SetTitleColor(color.Black)
	wnd.SetBackgroundColor(color.Black)
	wnd.HideCloseButton()

	// make sure same frame is delivered each time
	for i := 0; i < 10; i++ {
		im := wnd.Draw(0, 0)
		testCompareRender(t, []string{
			"########################################",
			"#,o,,,,,,,,,,,o,,,,,,,,,,,,,,,,,o,,,,,,#",
			"#,05,,,,,,,,,6O,,,,5O006,,,,,,,5#5,,,,,#",
			"#,OO,,,,,,,,,05,,,O5,,,50,,,,,,0#O,,,,,#",
			"#,50+,,,,,,,5#+,,55,,,,,56,,,,o#O#+,,,,#",
			"#,+#5,,+5,,,00,,,O,,,,,,,0,,,,60+06,,,,#",
			"#,,0O,,0#o,o#6,,,O,,,,,,,O+,,,06,O0,,,,#",
			"#,,6#+5##O,O#+,,,O,,,,,,,O+,,5#o,o#5,,,#",
			"#,,o#60#0#500,,,,O,,,,,,,0,,,00,,,#O,,,#",
			"#,,+###0+###6,,,,5O+,,,+O6,,o#######+,,#",
			"#,,,0##o,O##o,,,,,O#####0,,,6#+,,,o#6,,#",
			"#,,,6#0,,o00,,,,,,,5O006,,,,00,,,,,00,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"#,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,#",
			"########################################",
		}, renderAsText(im))
	}
}
